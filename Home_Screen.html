<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Anatomy Annotator ðŸ«€</title>

  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json" />
  <!-- PWA iOS support -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Anatomy Annotator" />
  <link rel="apple-touch-icon" href="/icons/icon-192x192.png" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />

  <style>
    /* Reset & base */
    html, body {
      margin: 0; padding: 0;
      height: 100%;
      font-family: 'Inter', sans-serif;
      background: #0D47A1;
      color: #eee;
      overflow-x: hidden;
      position: relative;
    }

    /* Canvas full screen */
    canvas#background {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 0;
    }

    /* Main content above canvas */
    body > *:not(canvas) {
      position: relative;
      z-index: 2;
    }

    /* Header with fade-in */
    header {
      padding: 2rem 1rem 1rem;
      text-align: center;
      animation: fadeInDown 1.4s ease forwards;
      user-select: none;
    }
    header h1 {
      font-weight: 700;
      font-size: 2.8rem;
      letter-spacing: 0.04em;
      margin-bottom: 0.2rem;
      text-shadow: 0 0 10px rgba(38,166,154,0.8);
    }
    header p {
      font-size: 1.2rem;
      max-width: 720px;
      margin: auto;
      color: #b0bec5dd;
      text-shadow: 0 0 6px rgba(0,0,0,0.3);
    }

    /* Glassmorphism container */
    .select-section {
      margin: 3rem auto 5rem;
      max-width: 360px;
      backdrop-filter: blur(12px);
      background: rgba(20, 40, 55, 0.4);
      border-radius: 18px;
      box-shadow: 0 8px 32px rgba(0,128,128,0.4);
      padding: 2rem 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 1.8rem;
      animation: fadeInUp 1.4s ease forwards 0.6s;
      user-select: none;
    }

    /* Specialties buttons */
    .specialty-btn {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1.1rem 1.6rem;
      border-radius: 9999px;
      font-weight: 600;
      font-size: 1.25rem;
      color: #e0f2f1;
      cursor: pointer;
      border: none;
      background: linear-gradient(145deg, #00897b, #004d40);
      box-shadow:
        0 0 10px rgba(0,255,255,0.3),
        inset 0 2px 6px rgba(255,255,255,0.15);
      transition:
        transform 0.25s ease,
        box-shadow 0.25s ease,
        background 0.4s ease;
      user-select: none;
    }
    .specialty-btn svg {
      width: 28px; height: 28px;
      fill: #4db6ac;
      transition: fill 0.3s ease;
    }

    /* Hover & focus */
    .specialty-btn:hover:not(:disabled),
    .specialty-btn:focus-visible:not(:disabled) {
      background: linear-gradient(145deg, #26a69a, #00bcd4);
      box-shadow:
        0 0 18px rgba(0,255,255,0.6),
        inset 0 4px 12px rgba(255,255,255,0.25);
      transform: scale(1.05);
      outline: none;
    }
    .specialty-btn:hover svg,
    .specialty-btn:focus-visible svg {
      fill: #a7ffeb;
    }

    /* Disabled style */
    .specialty-btn:disabled {
      cursor: not-allowed;
      color: #78909c;
      background: rgba(30, 70, 90, 0.4);
      box-shadow: none;
      transform: none;
      filter: grayscale(60%);
    }

    /* Locked button vibrate on click */
    .locked-vibrate {
      animation: vibrate 0.3s linear 1;
      box-shadow:
        0 0 20px #ff5252,
        inset 0 0 15px #ff1744;
    }

    /* Footer */
    footer {
      text-align: center;
      font-size: 0.9rem;
      color: #90a4ae;
      padding: 2rem 1rem;
      user-select: none;
      z-index: 5;
    }

    /* Animations */
    @keyframes fadeInUp {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @keyframes fadeInDown {
      0% {
        opacity: 0;
        transform: translateY(-30px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @keyframes vibrate {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-3px); }
      40%, 80% { transform: translateX(3px); }
    }

    /* Loader overlay */
    #loader {
      position: fixed;
      inset: 0;
      background: #004d40dd;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(4px);
      z-index: 99;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
    }
    #loader.active {
      opacity: 1;
      pointer-events: all;
    }
    /* Loader spinner */
    #loader .spinner {
      border: 4px solid #004d40;
      border-top: 4px solid #26a69a;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      animation: spin 1s linear infinite;
      box-shadow: 0 0 12px #26a69a;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive tweaks */
    @media (max-width: 480px) {
      header h1 {
        font-size: 2rem;
      }
      .specialty-btn {
        font-size: 1rem;
        padding: 0.9rem 1.2rem;
        gap: 0.7rem;
      }
      .specialty-btn svg {
        width: 22px; height: 22px;
      }
    }
  </style>
</head>
<body>

  <canvas id="background"></canvas>

  <header>
    <h1>Anatomy Annotator ðŸ«€</h1>
    <p>Plateforme chirurgicale intelligente. SÃ©lectionnez votre spÃ©cialitÃ© pour dÃ©buter une annotation prÃ©cise et assistÃ©e par IA.</p>
  </header>

  <section class="select-section" role="main" aria-label="SÃ©lection de la spÃ©cialitÃ© chirurgicale">
    <button class="specialty-btn" data-specialty="digestive" aria-label="Chirurgie digestive - disponible">
      <!-- Foie SVG -->
      <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M3 13c0-4 4-9 9-9s9 5 9 9c0 5-4 8-9 8S3 18 3 13z"></path>
      </svg>
      Chirurgie digestive
    </button>

    <button class="specialty-btn" disabled aria-label="Chirurgie cardiaque - bientÃ´t disponible">
      <!-- Coeur SVG -->
      <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M12 21s-1-.45-2-1.2C7 17 4 13 4 9a4 4 0 018-3 4 4 0 018 3c0 4-3 8-6 10.8-1 1-2 1.2-2 1.2z"></path>
      </svg>
      Chirurgie cardiaque
    </button>

    <button class="specialty-btn" disabled aria-label="Chirurgie vasculaire - bientÃ´t disponible">
      <!-- Vaisseau sanguin SVG -->
      <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <circle cx="12" cy="12" r="6"></circle>
        <path d="M12 6v12"></path>
        <path d="M6 12h12"></path>
      </svg>
      Chirurgie vasculaire
    </button>

    <button class="specialty-btn" disabled aria-label="Chirurgie thoracique - bientÃ´t disponible">
      <!-- Poumon SVG -->
      <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M8 5s-1 3-1 6 1 6 1 6"></path>
        <path d="M16 5s1 3 1 6-1 6-1 6"></path>
        <path d="M8 5h8v14H8z"></path>
      </svg>
      Chirurgie thoracique
    </button>
  </section>

  <footer>
    Â© 2025 Anatomy Annotator â€“ Tous droits rÃ©servÃ©s.
  </footer>

  <!-- Loader -->
  <div id="loader" role="alert" aria-live="assertive" aria-label="Chargement">
    <div class="spinner"></div>
  </div>

  <!-- Bootstrap Bundle JS for dropdowns (if needed) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // PWA Service Worker Registration
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('Service Worker registered with scope:', registration.scope);
          })
          .catch(error => {
            console.error('Service Worker registration failed:', error);
          });
      });
    }

    // Audio feedback setup
    const clickAudio = new Audio('data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAABCxAgAEABAAZGF0YQAAAAA='); // silent fallback
    // For a soft "click" sound, replace with real base64 audio or external file if needed

    // Specialty buttons logic
    const buttons = document.querySelectorAll('.specialty-btn');

    buttons.forEach(btn => {
      btn.addEventListener('click', () => {
        if (btn.disabled) {
          // Vibrate locked button + glow
          btn.classList.add('locked-vibrate');
          clickAudio.pause();
          // Soft error beep (optional, here silent fallback)
          setTimeout(() => {
            btn.classList.remove('locked-vibrate');
          }, 300);
        } else {
          // Play click sound
          clickAudio.currentTime = 0;
          clickAudio.play().catch(() => {});

          // Show loader and redirect after delay
          const loader = document.getElementById('loader');
          loader.classList.add('active');

          setTimeout(() => {
            localStorage.setItem('specialty', btn.dataset.specialty);
            window.location.href = 'index.html';
          }, 1200);
        }
      });
    });

    // Canvas background network particles (improved)
    const canvas = document.getElementById('background');
    const ctx = canvas.getContext('2d');
    let w, h;
    let particles = [];

    function randomRange(min, max) {
      return Math.random() * (max - min) + min;
    }

    function initCanvas() {
      w = canvas.width = window.innerWidth;
      h = canvas.height = window.innerHeight;
      particles = [];
      for (let i = 0; i < 70; i++) {
        particles.push({
          x: Math.random() * w,
          y: Math.random() * h,
          vx: randomRange(-0.6, 0.6),
          vy: randomRange(-0.6, 0.6),
          r: randomRange(1.5, 3),
        });
      }
    }

    function draw() {
      ctx.clearRect(0, 0, w, h);
      for (let i = 0; i < particles.length; i++) {
        const p = particles[i];
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        ctx.fillStyle = '#26a69a';
        ctx.shadowColor = '#00bcd4';
        ctx.shadowBlur = 6;
        ctx.fill();

        for (let j = i + 1; j < particles.length; j++) {
          const p2 = particles[j];
          const dx = p.x - p2.x;
          const dy = p.y - p2.y;
          const dist = Math.sqrt(dx * dx + dy * dy);
          if (dist < 130) {
            ctx.beginPath();
            ctx.moveTo(p.x, p.y);
            ctx.lineTo(p2.x, p2.y);
            ctx.strokeStyle = `rgba(38,166,154,${1 - dist / 130})`;
            ctx.lineWidth = 1;
            ctx.shadowBlur = 0;
            ctx.stroke();
          }
        }

        p.x += p.vx;
        p.y += p.vy;

        if (p.x < 0 || p.x > w) p.vx *= -1;
        if (p.y < 0 || p.y > h) p.vy *= -1;
      }
      requestAnimationFrame(draw);
    }

    window.addEventListener('resize', () => {
      initCanvas();
    });

    initCanvas();
    draw();

    </script>
  </body>
</html>
